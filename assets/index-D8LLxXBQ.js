(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();const g="00:00",w="Workout complete!",f=1e3,p=60,y={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},o={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={current:{index:null,name:null,time:null},intervalId:null,process:o.idle,timers:[]},E=t=>{const[e,i]=t.split(":").map(Number);return e*p+i},b=t=>{const e=String(Math.floor(t/p)).padStart(2,"0"),i=String(t%p).padStart(2,"0");return`${e}:${i}`},I=async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok");return await e.json()}catch(e){return console.error("Failed to fetch:",e),[]}},S=async()=>{const e=new URLSearchParams(window.location.search).get("url");return e?await I(e):JSON.parse(localStorage.getItem("timers"))||[]},x=t=>new Promise(e=>setTimeout(e,t)),u=new(window.AudioContext||window.webkitAudioContext),h=async(t=500,e=1)=>new Promise(i=>{const n=u.createOscillator(),s=u.createGain();n.connect(s),s.connect(u.destination),s.gain.value=e,n.frequency.value=1e3,n.type="sine",n.start(u.currentTime),n.stop(u.currentTime+t/f),n.onended=async()=>{await x(500),i()}}),L=t=>{const e=new SpeechSynthesisUtterance(t);window.speechSynthesis.speak(e)},k=()=>{if(!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)))return;const e=()=>{const i=new SpeechSynthesisUtterance("hello");i.volume=0,speechSynthesis.speak(i),document.removeEventListener("click",e)};document.addEventListener("click",e)},C=()=>{const t=document.querySelector("body"),e=document.createElement("p");e.classList.add("version"),e.textContent="v1.2.0",t.appendChild(e)},O=(t,e)=>{t.timer.textContent=e.current.time?e.current.time:g},T=(t,e)=>(i,n)=>{const s=document.createElement("button"),r=document.createElement("span"),c=document.createElement("span"),a=document.createElement("li");s.classList.add("remove"),s.setAttribute("type","button"),s.textContent="âœ–",s.dataset.index=n,r.classList.add("text","name"),r.textContent=i.name,c.classList.add("text","time"),c.textContent=i.time,a.classList.add("item"),a.classList.toggle("active",e===n),a.appendChild(s),a.appendChild(r),a.appendChild(c),t.appendChild(a)},P=(t,e)=>{const{list:i}=t;i.innerHTML="",e.timers.forEach(T(i,e.current.index))},N=(t,e)=>{const{add:i,form:n,name:s,pause:r,reset:c,start:a}=t;switch(e.process){case o.idle:i.classList.remove("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),a.classList.add("hidden");break;case o.add:i.classList.add("hidden"),n.classList.remove("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),a.classList.add("hidden"),s.focus();break;case o.ready:i.classList.remove("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),a.classList.remove("hidden"),n.reset();break;case o.countdown:i.classList.add("hidden"),n.classList.add("hidden"),c.classList.remove("hidden"),r.classList.remove("hidden"),a.classList.add("hidden");break;case o.pause:i.classList.add("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),c.classList.remove("hidden"),a.classList.remove("hidden");break}},B=(t,e)=>{C(),P(t,e),O(t,e),N(t,e)},m=new NoSleep,l=t=>{Object.assign(d,t),B(y,d),localStorage.setItem("timers",JSON.stringify(d.timers))},v=()=>{clearInterval(d.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:o.ready}),m==null||m.disable()},A=t=>{const e=new FormData(t.target),i=Object.fromEntries(e.entries()),n=[...d.timers,i];l({process:o.ready,timers:n})},M=t=>{const e=!t.target.classList.contains("remove"),i=d.process===o.countdown;if(e||i)return;const n=[...d.timers],s=t.target.dataset.index;n.splice(s,1),l({process:n.length>0?o.ready:o.idle,timers:n})},q=()=>l({process:o.add}),j=()=>{clearInterval(d.intervalId),l({intervalId:null,process:o.pause})},F=()=>v(),R=async()=>{const t=d.current.index,e=t+1,i=d.timers.length-1===t,n=E(d.current.time)-1,s=b(n);if(l({current:{index:t,name:d.timers[t].name,time:s}}),n>0&&n<=3&&h(100),n===0){if(i){v(),L(w);return}await h(),L(d.timers[e].name),l({current:{index:e,...d.timers[e]}})}},U=async()=>{const t=d.current.time?d.current:{index:0,...d.timers[0]};m==null||m.enable(),await h(),L(t.name),d.intervalId=setInterval(R,f),l({current:t,process:o.countdown})},$=async()=>{const{form:t,list:e,add:i,pause:n,reset:s,start:r}=y,c=await S();t.addEventListener("submit",A),e.addEventListener("click",M),i.addEventListener("click",q),n.addEventListener("click",j),s.addEventListener("click",F),r.addEventListener("click",U),l({process:c.length>0?o.ready:o.idle,timers:c}),k()};document.addEventListener("DOMContentLoaded",$);
