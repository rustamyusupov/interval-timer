(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const L="00:00",f=1e3,m=60,c={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={audioCtx:null,current:{index:null,time:null},intervalId:null,noSleep:null,process:c.idle,timers:[]},g=(e,t)=>{e.timer.textContent=t.current.time?t.current.time:L},v=(e,t)=>(r,s)=>{const n=document.createElement("button"),i=document.createElement("span"),o=document.createElement("span"),a=document.createElement("li");n.classList.add("remove"),n.setAttribute("type","button"),n.textContent="âœ–",n.dataset.index=s,i.classList.add("text","name"),i.textContent=r.name,o.classList.add("text","time"),o.textContent=r.time,a.classList.add("item"),a.classList.toggle("active",t===s),a.appendChild(n),a.appendChild(i),a.appendChild(o),e.appendChild(a)},y=(e,t)=>{const{list:r}=e;r.innerHTML="",t.timers.forEach(v(r,t.current.index))},w=(e,t)=>{const{add:r,form:s,name:n,pause:i,reset:o,start:a}=e;switch(t.process){case c.idle:r.classList.remove("hidden"),s.classList.add("hidden"),i.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden");break;case c.add:r.classList.add("hidden"),s.classList.remove("hidden"),i.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),n.focus();break;case c.ready:r.classList.remove("hidden"),s.classList.add("hidden"),i.classList.add("hidden"),o.classList.add("hidden"),a.classList.remove("hidden"),s.reset();break;case c.countdown:r.classList.add("hidden"),s.classList.add("hidden"),o.classList.remove("hidden"),i.classList.remove("hidden"),a.classList.add("hidden");break;case c.pause:r.classList.add("hidden"),s.classList.add("hidden"),i.classList.add("hidden"),o.classList.remove("hidden"),a.classList.remove("hidden");break}},I=(e,t)=>{g(e,t),w(e,t),y(e,t)},E=e=>{const[t,r]=e.split(":").map(Number);return t*m+r},x=e=>{const t=String(Math.floor(e/m)).padStart(2,"0"),r=String(e%m).padStart(2,"0");return`${t}:${r}`},C=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){return console.error("Failed to fetch:",t),[]}},u=({ctx:e,duration:t=100,frequency:r=1e3,volume:s=2,type:n="triangle"})=>{if(!e){console.warn("AudioContext is not provided");return}const i=e.createOscillator(),o=e.createGain();i.connect(o),o.connect(e.destination),o.gain.value=s,i.frequency.value=r,i.type=n,i.start(e.currentTime),i.stop(e.currentTime+t/1e3)},p={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},l=e=>{Object.assign(d,e),I(p,d),localStorage.setItem("timers",JSON.stringify(d.timers))},h=()=>{var e;clearInterval(d.intervalId),l({intervalId:null,current:{index:null,time:null},process:c.ready}),(e=d.noSleep)==null||e.disable()},S=e=>{const t=new FormData(e.target),r=Object.fromEntries(t.entries()),s=[...d.timers,r];l({process:c.ready,timers:s})},b=e=>{const t=!e.target.classList.contains("remove"),r=d.process===c.countdown;if(t||r)return;const s=[...d.timers],n=e.target.dataset.index;s.splice(n,1),l({process:s.length>0?c.ready:c.idle,timers:s})},k=()=>l({process:c.add}),O=()=>{clearInterval(d.intervalId),l({intervalId:null,process:c.pause})},T=()=>h(),N=()=>{const e=d.current.index,t=e+1,r=d.timers.length-1===e,s=E(d.current.time)-1,n=x(s);if(l({current:{index:e,time:n}}),s>0&&s<=3&&u({ctx:d.audioCtx}),s===0){if(r){h();return}u({ctx:d.audioCtx,duration:500}),l({current:{index:t,time:d.timers[t].time}})}},B=()=>{var t;const e=d.current.time?d.current:{index:0,time:d.timers[0].time};d.intervalId=setInterval(N,f),l({current:e,process:c.countdown}),u({ctx:d.audioCtx,duration:250}),(t=d.noSleep)==null||t.enable()},A=()=>{const{form:e,list:t,add:r,pause:s,reset:n,start:i}=p;e.addEventListener("submit",S),t.addEventListener("click",b),r.addEventListener("click",k),s.addEventListener("click",O),n.addEventListener("click",T),i.addEventListener("click",B)},P=async()=>{const e=new NoSleep,t=new(window.AudioContext||window.webkitAudioContext),s=new URLSearchParams(window.location.search).get("url");let n=[];s?(n=await C(s),localStorage.setItem("timers",JSON.stringify(n))):n=JSON.parse(localStorage.getItem("timers"))||[],A(),l({audioCtx:t,noSleep:e,process:n.length>0?c.ready:c.idle,timers:n})};document.addEventListener("DOMContentLoaded",P);
