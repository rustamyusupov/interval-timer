(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const I="00:00",b="Workout complete!",y=1e3,L=60,v=y/2,g={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},o={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},a={current:{index:null,name:null,time:null},intervalId:null,process:o.idle,timers:[]},u={delayMs:v,duration:v,frequency:1e3,volume:1,type:"sine"},S=t=>{const[e,s]=t.split(":").map(Number);return e*L+s},k=t=>{const e=String(Math.floor(t/L)).padStart(2,"0"),s=String(t%L).padStart(2,"0");return`${e}:${s}`},x=async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok");return await e.json()}catch(e){return console.error("Failed to fetch:",e),[]}},C=async()=>{const e=new URLSearchParams(window.location.search).get("url");return e?await x(e):JSON.parse(localStorage.getItem("timers"))||[]},w=t=>new Promise(e=>setTimeout(e,t)),p=new(window.AudioContext||window.webkitAudioContext),h=async({delayMs:t,duration:e,frequency:s,volume:i,type:n}={})=>new Promise(r=>{const d=p.createOscillator(),c=p.createGain();d.connect(c),c.connect(p.destination),c.gain.value=i??u.volume,d.frequency.value=s??u.frequency,d.type=n??u.type,d.start(p.currentTime),d.stop(p.currentTime+(e??u.duration)/y),d.onended=async()=>{await w(t??u.delayMs),r()}}),O=()=>{if(!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)))return;const e=()=>{const s=new SpeechSynthesisUtterance("hello");s.volume=0,speechSynthesis.speak(s),h({duration:100,volume:0}),document.removeEventListener("click",e)};document.addEventListener("click",e)},f=async(t,e=0)=>{const s=new SpeechSynthesisUtterance(t);window.speechSynthesis.speak(s),await w(e)},T=(t,e)=>{t.timer.textContent=e.current.time?e.current.time:I},P=(t,e)=>(s,i)=>{const n=document.createElement("button"),r=document.createElement("span"),d=document.createElement("span"),c=document.createElement("li");n.classList.add("remove"),n.setAttribute("type","button"),n.textContent="âœ–",n.dataset.index=i,r.classList.add("text","name"),r.textContent=s.name,d.classList.add("text","time"),d.textContent=s.time,c.classList.add("item"),c.classList.toggle("active",e===i),c.appendChild(n),c.appendChild(r),c.appendChild(d),t.appendChild(c)},N=(t,e)=>{const{list:s}=t;s.innerHTML="",e.timers.forEach(P(s,e.current.index))},B=(t,e)=>{const{add:s,form:i,name:n,pause:r,reset:d,start:c}=t;switch(e.process){case o.idle:s.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),d.classList.add("hidden"),c.classList.add("hidden");break;case o.add:s.classList.add("hidden"),i.classList.remove("hidden"),r.classList.add("hidden"),d.classList.add("hidden"),c.classList.add("hidden"),n.focus();break;case o.ready:s.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),d.classList.add("hidden"),c.classList.remove("hidden"),i.reset();break;case o.countdown:s.classList.add("hidden"),i.classList.add("hidden"),d.classList.remove("hidden"),r.classList.remove("hidden"),c.classList.add("hidden");break;case o.pause:s.classList.add("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),d.classList.remove("hidden"),c.classList.remove("hidden");break}},A=(t,e)=>{N(t,e),T(t,e),B(t,e)},m=new NoSleep,l=t=>{Object.assign(a,t),A(g,a),localStorage.setItem("timers",JSON.stringify(a.timers))},E=()=>{clearInterval(a.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:o.ready}),m==null||m.disable()},M=t=>{const e=new FormData(t.target),s=Object.fromEntries(e.entries()),i=[...a.timers,s];l({process:o.ready,timers:i})},q=t=>{const e=!t.target.classList.contains("remove"),s=a.process===o.countdown;if(e||s)return;const i=[...a.timers],n=t.target.dataset.index;i.splice(n,1),l({process:i.length>0?o.ready:o.idle,timers:i})},j=()=>l({process:o.add}),D=()=>{clearInterval(a.intervalId),l({intervalId:null,process:o.pause})},F=()=>E(),R=async()=>{const t=a.current.index,e=t+1,s=a.timers.length-1===t,i=S(a.current.time)-1,n=k(i);if(l({current:{index:t,name:a.timers[t].name,time:n}}),i>0&&i<=3&&h({duration:100}),i===0){if(s){E(),f(b);return}await h(),f(a.timers[e].name),l({current:{index:e,...a.timers[e]}})}},U=async()=>{const t=a.current.time?a.current:{index:0,...a.timers[0]};m==null||m.enable(),await h(),f(t.name),a.intervalId=setInterval(R,y),l({current:t,process:o.countdown})},J=async()=>{const{form:t,list:e,add:s,pause:i,reset:n,start:r}=g,d=await C();t.addEventListener("submit",M),e.addEventListener("click",q),s.addEventListener("click",j),i.addEventListener("click",D),n.addEventListener("click",F),r.addEventListener("click",U),l({process:d.length>0?o.ready:o.idle,timers:d}),O()};document.addEventListener("DOMContentLoaded",J);
