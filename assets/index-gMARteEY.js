(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();const g="00:00",w="Workout complete!",f=1e3,h=60,y={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},a={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={current:{index:null,name:null,time:null},intervalId:null,process:a.idle,timers:[]},E=t=>{const[e,i]=t.split(":").map(Number);return e*h+i},I=t=>{const e=String(Math.floor(t/h)).padStart(2,"0"),i=String(t%h).padStart(2,"0");return`${e}:${i}`},b=async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok");return await e.json()}catch(e){return console.error("Failed to fetch:",e),[]}},S=async()=>{const e=new URLSearchParams(window.location.search).get("url");return e?await b(e):JSON.parse(localStorage.getItem("timers"))||[]},k=t=>new Promise(e=>setTimeout(e,t)),m=new(window.AudioContext||window.webkitAudioContext),p=async(t=500,e=1)=>(m.state==="suspended"&&await m.resume(),new Promise(i=>{const n=m.createOscillator(),s=m.createGain();n.connect(s),s.connect(m.destination),s.gain.value=e,n.frequency.value=1e3,n.type="sine",n.start(m.currentTime),n.stop(m.currentTime+t/f),n.onended=async()=>{await k(500),i()}})),L=t=>{const e=new SpeechSynthesisUtterance(t);window.speechSynthesis.speak(e)},x=()=>{if(!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)))return;const e=()=>{const i=new SpeechSynthesisUtterance("hello");i.volume=0,speechSynthesis.speak(i),p(100,0),document.removeEventListener("click",e)};document.addEventListener("click",e)},C=(t,e)=>{t.timer.textContent=e.current.time?e.current.time:g},O=(t,e)=>(i,n)=>{const s=document.createElement("button"),r=document.createElement("span"),c=document.createElement("span"),o=document.createElement("li");s.classList.add("remove"),s.setAttribute("type","button"),s.textContent="âœ–",s.dataset.index=n,r.classList.add("text","name"),r.textContent=i.name,c.classList.add("text","time"),c.textContent=i.time,o.classList.add("item"),o.classList.toggle("active",e===n),o.appendChild(s),o.appendChild(r),o.appendChild(c),t.appendChild(o)},T=(t,e)=>{const{list:i}=t;i.innerHTML="",e.timers.forEach(O(i,e.current.index))},P=(t,e)=>{const{add:i,form:n,name:s,pause:r,reset:c,start:o}=t;switch(e.process){case a.idle:i.classList.remove("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),o.classList.add("hidden");break;case a.add:i.classList.add("hidden"),n.classList.remove("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),o.classList.add("hidden"),s.focus();break;case a.ready:i.classList.remove("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),o.classList.remove("hidden"),n.reset();break;case a.countdown:i.classList.add("hidden"),n.classList.add("hidden"),c.classList.remove("hidden"),r.classList.remove("hidden"),o.classList.add("hidden");break;case a.pause:i.classList.add("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),c.classList.remove("hidden"),o.classList.remove("hidden");break}},N=(t,e)=>{T(t,e),C(t,e),P(t,e)},u=new NoSleep,l=t=>{Object.assign(d,t),N(y,d),localStorage.setItem("timers",JSON.stringify(d.timers))},v=()=>{clearInterval(d.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:a.ready}),u==null||u.disable()},B=t=>{const e=new FormData(t.target),i=Object.fromEntries(e.entries()),n=[...d.timers,i];l({process:a.ready,timers:n})},A=t=>{const e=!t.target.classList.contains("remove"),i=d.process===a.countdown;if(e||i)return;const n=[...d.timers],s=t.target.dataset.index;n.splice(s,1),l({process:n.length>0?a.ready:a.idle,timers:n})},M=()=>l({process:a.add}),j=()=>{clearInterval(d.intervalId),l({intervalId:null,process:a.pause})},q=()=>v(),F=async()=>{const t=d.current.index,e=t+1,i=d.timers.length-1===t,n=E(d.current.time)-1,s=I(n);if(l({current:{index:t,name:d.timers[t].name,time:s}}),n>0&&n<=3&&p(100),n===0){if(i){v(),L(w);return}await p(),L(d.timers[e].name),l({current:{index:e,...d.timers[e]}})}},R=async()=>{const t=d.current.time?d.current:{index:0,...d.timers[0]};u==null||u.enable(),await p(),L(t.name),d.intervalId=setInterval(F,f),l({current:t,process:a.countdown})},U=async()=>{const{form:t,list:e,add:i,pause:n,reset:s,start:r}=y,c=await S();t.addEventListener("submit",B),e.addEventListener("click",A),i.addEventListener("click",M),n.addEventListener("click",j),s.addEventListener("click",q),r.addEventListener("click",R),l({process:c.length>0?a.ready:a.idle,timers:c}),x()};document.addEventListener("DOMContentLoaded",U);
