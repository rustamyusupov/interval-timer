(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const g="00:00",w="Workout complete!",f=1e3,u=60,y={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},a={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={current:{index:null,name:null,time:null},intervalId:null,process:a.idle,timers:[]},E=e=>{const[t,n]=e.split(":").map(Number);return t*u+n},I=e=>{const t=String(Math.floor(e/u)).padStart(2,"0"),n=String(e%u).padStart(2,"0");return`${t}:${n}`},b=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){return console.error("Failed to fetch:",t),[]}},S=async()=>{const t=new URLSearchParams(window.location.search).get("url");return t?await b(t):JSON.parse(localStorage.getItem("timers"))||[]},k=e=>new Promise(t=>setTimeout(t,e)),p=async(e,t=500,n=1)=>new Promise(i=>{const s=e.createOscillator(),r=e.createGain();s.connect(r),r.connect(e.destination),r.gain.value=n,s.frequency.value=1e3,s.type="sine",s.start(e.currentTime),s.stop(e.currentTime+t/f),s.onended=async()=>{await k(500),i()}}),h=e=>{const t=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(t)},C=()=>{if(!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)))return;const t=()=>{const n=new SpeechSynthesisUtterance("hello");n.volume=0,speechSynthesis.speak(n),document.removeEventListener("click",t)};document.addEventListener("click",t)},x=(e,t)=>{e.timer.textContent=t.current.time?t.current.time:g},O=(e,t)=>(n,i)=>{const s=document.createElement("button"),r=document.createElement("span"),c=document.createElement("span"),o=document.createElement("li");s.classList.add("remove"),s.setAttribute("type","button"),s.textContent="âœ–",s.dataset.index=i,r.classList.add("text","name"),r.textContent=n.name,c.classList.add("text","time"),c.textContent=n.time,o.classList.add("item"),o.classList.toggle("active",t===i),o.appendChild(s),o.appendChild(r),o.appendChild(c),e.appendChild(o)},T=(e,t)=>{const{list:n}=e;n.innerHTML="",t.timers.forEach(O(n,t.current.index))},P=(e,t)=>{const{add:n,form:i,name:s,pause:r,reset:c,start:o}=e;switch(t.process){case a.idle:n.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),o.classList.add("hidden");break;case a.add:n.classList.add("hidden"),i.classList.remove("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),o.classList.add("hidden"),s.focus();break;case a.ready:n.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),o.classList.remove("hidden"),i.reset();break;case a.countdown:n.classList.add("hidden"),i.classList.add("hidden"),c.classList.remove("hidden"),r.classList.remove("hidden"),o.classList.add("hidden");break;case a.pause:n.classList.add("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),c.classList.remove("hidden"),o.classList.remove("hidden");break}},N=(e,t)=>{T(e,t),x(e,t),P(e,t)},m=new NoSleep,L=new(window.AudioContext||window.webkitAudioContext),l=e=>{Object.assign(d,e),N(y,d),localStorage.setItem("timers",JSON.stringify(d.timers))},v=()=>{clearInterval(d.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:a.ready}),m==null||m.disable()},B=e=>{const t=new FormData(e.target),n=Object.fromEntries(t.entries()),i=[...d.timers,n];l({process:a.ready,timers:i})},A=e=>{const t=!e.target.classList.contains("remove"),n=d.process===a.countdown;if(t||n)return;const i=[...d.timers],s=e.target.dataset.index;i.splice(s,1),l({process:i.length>0?a.ready:a.idle,timers:i})},M=()=>l({process:a.add}),j=()=>{clearInterval(d.intervalId),l({intervalId:null,process:a.pause})},q=()=>v(),F=async()=>{const e=d.current.index,t=e+1,n=d.timers.length-1===e,i=E(d.current.time)-1,s=I(i);if(l({current:{index:e,name:d.timers[e].name,time:s}}),i>0&&i<=3&&p(L,100),i===0){if(n){v(),h(w);return}await p(L),h(d.timers[t].name),l({current:{index:t,...d.timers[t]}})}},R=async()=>{const e=d.current.time?d.current:{index:0,...d.timers[0]};m==null||m.enable(),await p(L),h(e.name),d.intervalId=setInterval(F,f),l({current:e,process:a.countdown})},U=async()=>{const{form:e,list:t,add:n,pause:i,reset:s,start:r}=y,c=await S();e.addEventListener("submit",B),t.addEventListener("click",A),n.addEventListener("click",M),i.addEventListener("click",j),s.addEventListener("click",q),r.addEventListener("click",R),l({process:c.length>0?a.ready:a.idle,timers:c}),C()};document.addEventListener("DOMContentLoaded",U);
