(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const v="00:00",g="Workout complete!",L=1e3,u=60,f={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},o={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={audioCtx:null,current:{index:null,name:null,time:null},intervalId:null,process:o.idle,timers:[]},w=t=>{const[e,n]=t.split(":").map(Number);return e*u+n},E=t=>{const e=String(Math.floor(t/u)).padStart(2,"0"),n=String(t%u).padStart(2,"0");return`${e}:${n}`},b=async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok");return await e.json()}catch(e){return console.error("Failed to fetch:",e),[]}},C=async()=>{const e=new URLSearchParams(window.location.search).get("url");return e?await b(e):JSON.parse(localStorage.getItem("timers"))||[]},I=t=>new Promise(e=>setTimeout(e,t)),p=async(t,e=500,n=1)=>new Promise(i=>{const s=t.createOscillator(),r=t.createGain();s.connect(r),r.connect(t.destination),r.gain.value=n,s.frequency.value=1e3,s.type="sine",s.start(t.currentTime),s.stop(t.currentTime+e/L),s.onended=async()=>{await I(500),i()}}),h=t=>{const e=new SpeechSynthesisUtterance(t);window.speechSynthesis.speak(e)},S=()=>{if(!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)))return;const e=()=>{const n=new SpeechSynthesisUtterance("hello");n.volume=0,speechSynthesis.speak(n),document.removeEventListener("click",e)};document.addEventListener("click",e)},x=()=>{const t=document.querySelector("body"),e=document.createElement("p");e.classList.add("version"),e.textContent="v1.1.0",t.appendChild(e)},k=(t,e)=>{t.timer.textContent=e.current.time?e.current.time:v},O=(t,e)=>(n,i)=>{const s=document.createElement("button"),r=document.createElement("span"),a=document.createElement("span"),c=document.createElement("li");s.classList.add("remove"),s.setAttribute("type","button"),s.textContent="âœ–",s.dataset.index=i,r.classList.add("text","name"),r.textContent=n.name,a.classList.add("text","time"),a.textContent=n.time,c.classList.add("item"),c.classList.toggle("active",e===i),c.appendChild(s),c.appendChild(r),c.appendChild(a),t.appendChild(c)},T=(t,e)=>{const{list:n}=t;n.innerHTML="",e.timers.forEach(O(n,e.current.index))},P=(t,e)=>{const{add:n,form:i,name:s,pause:r,reset:a,start:c}=t;switch(e.process){case o.idle:n.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),a.classList.add("hidden"),c.classList.add("hidden");break;case o.add:n.classList.add("hidden"),i.classList.remove("hidden"),r.classList.add("hidden"),a.classList.add("hidden"),c.classList.add("hidden"),s.focus();break;case o.ready:n.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),a.classList.add("hidden"),c.classList.remove("hidden"),i.reset();break;case o.countdown:n.classList.add("hidden"),i.classList.add("hidden"),a.classList.remove("hidden"),r.classList.remove("hidden"),c.classList.add("hidden");break;case o.pause:n.classList.add("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),a.classList.remove("hidden"),c.classList.remove("hidden");break}},N=(t,e)=>{x(),T(t,e),k(t,e),P(t,e)},m=new NoSleep,l=t=>{Object.assign(d,t),N(f,d),localStorage.setItem("timers",JSON.stringify(d.timers))},y=()=>{clearInterval(d.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:o.ready}),m==null||m.disable()},B=t=>{const e=new FormData(t.target),n=Object.fromEntries(e.entries()),i=[...d.timers,n];l({process:o.ready,timers:i})},A=t=>{const e=!t.target.classList.contains("remove"),n=d.process===o.countdown;if(e||n)return;const i=[...d.timers],s=t.target.dataset.index;i.splice(s,1),l({process:i.length>0?o.ready:o.idle,timers:i})},M=()=>l({process:o.add}),q=()=>{clearInterval(d.intervalId),l({intervalId:null,process:o.pause})},j=()=>y(),F=async()=>{const t=d.current.index,e=t+1,n=d.timers.length-1===t,i=w(d.current.time)-1,s=E(i);if(l({current:{index:t,name:d.timers[t].name,time:s}}),i>0&&i<=3&&p(d.audioCtx,100),i===0){if(n){y(),h(g);return}await p(d.audioCtx),h(d.timers[e].name),l({current:{index:e,...d.timers[e]}})}},R=async()=>{const t=d.current.time?d.current:{index:0,...d.timers[0]};m==null||m.enable(),await p(d.audioCtx),h(t.name),d.intervalId=setInterval(F,L),l({current:t,process:o.countdown})},U=async()=>{const t=new(window.AudioContext||window.webkitAudioContext),{form:e,list:n,add:i,pause:s,reset:r,start:a}=f,c=await C();e.addEventListener("submit",B),n.addEventListener("click",A),i.addEventListener("click",M),s.addEventListener("click",q),r.addEventListener("click",j),a.addEventListener("click",R),l({audioCtx:t,process:c.length>0?o.ready:o.idle,timers:c}),S()};document.addEventListener("DOMContentLoaded",U);
