(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const b="00:00",S="Workout complete!",v=1e3,h=60,g=v/2,w={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},o={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={current:{index:null,name:null,time:null},intervalId:null,process:o.idle,timers:[]},u={delayMs:g,duration:g,frequency:1e3,volume:1,type:"sine"},k=(e,t)=>{e.timer.textContent=t.current.time?t.current.time:b},x=(e,t)=>(s,r)=>{const n=document.createElement("button"),i=document.createElement("span"),a=document.createElement("span"),c=document.createElement("li");n.classList.add("remove"),n.setAttribute("type","button"),n.textContent="âœ–",n.dataset.index=r,i.classList.add("text","name"),i.textContent=s.name,a.classList.add("text","time"),a.textContent=s.time,c.classList.add("item"),c.classList.toggle("active",t===r),c.appendChild(n),c.appendChild(i),c.appendChild(a),e.appendChild(c)},C=(e,t)=>{const{list:s}=e;s.innerHTML="",t.timers.forEach(x(s,t.current.index))},O=(e,t)=>{const{add:s,form:r,name:n,pause:i,reset:a,start:c}=e;switch(t.process){case o.idle:s.classList.remove("hidden"),r.classList.add("hidden"),i.classList.add("hidden"),a.classList.add("hidden"),c.classList.add("hidden");break;case o.add:s.classList.add("hidden"),r.classList.remove("hidden"),i.classList.add("hidden"),a.classList.add("hidden"),c.classList.add("hidden"),n.focus();break;case o.ready:s.classList.remove("hidden"),r.classList.add("hidden"),i.classList.add("hidden"),a.classList.add("hidden"),c.classList.remove("hidden"),r.reset();break;case o.countdown:s.classList.add("hidden"),r.classList.add("hidden"),a.classList.remove("hidden"),i.classList.remove("hidden"),c.classList.add("hidden");break;case o.pause:s.classList.add("hidden"),r.classList.add("hidden"),i.classList.add("hidden"),a.classList.remove("hidden"),c.classList.remove("hidden");break}},T=(e,t)=>{C(e,t),k(e,t),O(e,t)},P=e=>{const[t,s]=e.split(":").map(Number);return t*h+s},N=e=>{const t=String(Math.floor(e/h)).padStart(2,"0"),s=String(e%h).padStart(2,"0");return`${t}:${s}`},B=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){return console.error("Failed to fetch:",t),[]}},M=async()=>{const t=new URLSearchParams(window.location.search).get("url");return t?await B(t):JSON.parse(localStorage.getItem("timers"))||[]},E=e=>new Promise(t=>setTimeout(t,e)),L=async({audioCtx:e,delayMs:t,duration:s,frequency:r,volume:n,type:i})=>new Promise(a=>{const c=e.createOscillator(),p=e.createGain();c.connect(p),p.connect(e.destination),p.gain.value=n??u.volume,c.frequency.value=r??u.frequency,c.type=i??u.type,c.start(e.currentTime),c.stop(e.currentTime+(s??u.duration)/v),c.onended=async()=>{await E(t??u.delayMs),a()}}),q=()=>{if(!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)))return;const t=()=>{const s=new SpeechSynthesisUtterance("hello");s.volume=0,speechSynthesis.speak(s),document.removeEventListener("click",t)};document.addEventListener("click",t)},f=async(e,t=0)=>{const s=new SpeechSynthesisUtterance(e);s.pitch=1,s.volume=1,s.rate=1,window.speechSynthesis.speak(s),await E(t)},m=new NoSleep,y=new(window.AudioContext||window.webkitAudioContext),l=e=>{Object.assign(d,e),T(w,d),localStorage.setItem("timers",JSON.stringify(d.timers))},I=()=>{clearInterval(d.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:o.ready}),m==null||m.disable()},A=e=>{const t=new FormData(e.target),s=Object.fromEntries(t.entries()),r=[...d.timers,s];l({process:o.ready,timers:r})},j=e=>{const t=!e.target.classList.contains("remove"),s=d.process===o.countdown;if(t||s)return;const r=[...d.timers],n=e.target.dataset.index;r.splice(n,1),l({process:r.length>0?o.ready:o.idle,timers:r})},D=()=>l({process:o.add}),F=()=>{clearInterval(d.intervalId),l({intervalId:null,process:o.pause})},R=()=>I(),U=async()=>{const e=d.current.index,t=e+1,s=d.timers.length-1===e,r=P(d.current.time)-1,n=N(r);if(l({current:{index:e,name:d.timers[e].name,time:n}}),r>0&&r<=3&&L({audioCtx:y,duration:100}),r===0){if(s){I(),f(S);return}await L({audioCtx:y}),f(d.timers[t].name),l({current:{index:t,...d.timers[t]}})}},J=async()=>{const e=d.current.time?d.current:{index:0,...d.timers[0]};m==null||m.enable(),await L({audioCtx:y}),f(e.name),d.intervalId=setInterval(U,v),l({current:e,process:o.countdown})},$=async()=>{const{form:e,list:t,add:s,pause:r,reset:n,start:i}=w,a=await M();e.addEventListener("submit",A),t.addEventListener("click",j),s.addEventListener("click",D),r.addEventListener("click",F),n.addEventListener("click",R),i.addEventListener("click",J),l({process:a.length>0?o.ready:o.idle,timers:a}),q()};document.addEventListener("DOMContentLoaded",$);
