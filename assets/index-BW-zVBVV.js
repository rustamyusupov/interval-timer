(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const S="00:00",I="Workout complete!",f=1e3,p=60,y=f/2,o={idle:"idle",add:"add",ready:"ready",countdown:"countdown",pause:"pause"},d={audioCtx:null,current:{index:null,name:null,time:null},intervalId:null,noSleep:null,process:o.idle,timers:[]},m={delayMs:y,duration:y,frequency:1e3,volume:1,type:"sine"},E=(e,t)=>{e.timer.textContent=t.current.time?t.current.time:S},x=(e,t)=>(s,i)=>{const n=document.createElement("button"),r=document.createElement("span"),c=document.createElement("span"),a=document.createElement("li");n.classList.add("remove"),n.setAttribute("type","button"),n.textContent="âœ–",n.dataset.index=i,r.classList.add("text","name"),r.textContent=s.name,c.classList.add("text","time"),c.textContent=s.time,a.classList.add("item"),a.classList.toggle("active",t===i),a.appendChild(n),a.appendChild(r),a.appendChild(c),e.appendChild(a)},C=(e,t)=>{const{list:s}=e;s.innerHTML="",t.timers.forEach(x(s,t.current.index))},b=(e,t)=>{const{add:s,form:i,name:n,pause:r,reset:c,start:a}=e;switch(t.process){case o.idle:s.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),a.classList.add("hidden");break;case o.add:s.classList.add("hidden"),i.classList.remove("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),a.classList.add("hidden"),n.focus();break;case o.ready:s.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden"),a.classList.remove("hidden"),i.reset();break;case o.countdown:s.classList.add("hidden"),i.classList.add("hidden"),c.classList.remove("hidden"),r.classList.remove("hidden"),a.classList.add("hidden");break;case o.pause:s.classList.add("hidden"),i.classList.add("hidden"),r.classList.add("hidden"),c.classList.remove("hidden"),a.classList.remove("hidden");break}},k=(e,t)=>{C(e,t),E(e,t),b(e,t)},O=e=>{const[t,s]=e.split(":").map(Number);return t*p+s},T=e=>{const t=String(Math.floor(e/p)).padStart(2,"0"),s=String(e%p).padStart(2,"0");return`${t}:${s}`},N=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){return console.error("Failed to fetch:",t),[]}},g=e=>new Promise(t=>setTimeout(t,e)),h=async(e,t=0)=>{const s=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(s),await g(t)},L=async({ctx:e,delayMs:t,duration:s,frequency:i,volume:n,type:r})=>new Promise(c=>{const a=e.createOscillator(),u=e.createGain();a.connect(u),u.connect(e.destination),u.gain.value=n??m.volume,a.frequency.value=i??m.frequency,a.type=r??m.type,a.start(e.currentTime),a.stop(e.currentTime+(s??m.duration)/f),a.onended=async()=>{await g(t??m.delayMs),c()}}),v={add:document.getElementById("add"),form:document.getElementById("form"),list:document.getElementById("list"),name:document.getElementById("name"),pause:document.getElementById("pause"),reset:document.getElementById("reset"),start:document.getElementById("start"),timer:document.getElementById("timer")},l=e=>{Object.assign(d,e),k(v,d),localStorage.setItem("timers",JSON.stringify(d.timers))},w=()=>{var e;clearInterval(d.intervalId),l({intervalId:null,current:{index:null,name:null,time:null},process:o.ready}),(e=d.noSleep)==null||e.disable()},P=e=>{const t=new FormData(e.target),s=Object.fromEntries(t.entries()),i=[...d.timers,s];l({process:o.ready,timers:i})},B=e=>{const t=!e.target.classList.contains("remove"),s=d.process===o.countdown;if(t||s)return;const i=[...d.timers],n=e.target.dataset.index;i.splice(n,1),l({process:i.length>0?o.ready:o.idle,timers:i})},M=()=>l({process:o.add}),q=()=>{clearInterval(d.intervalId),l({intervalId:null,process:o.pause})},A=()=>w(),j=async()=>{const e=d.current.index,t=e+1,s=d.timers.length-1===e,i=O(d.current.time)-1,n=T(i);if(l({current:{index:e,name:d.timers[e].name,time:n}}),i>0&&i<=3&&L({ctx:d.audioCtx,duration:100}),i===0){if(s){w(),h(I);return}await L({ctx:d.audioCtx}),h(d.timers[t].name),l({current:{index:t,...d.timers[t]}})}},D=async()=>{var t;const e=d.current.time?d.current:{index:0,...d.timers[0]};(t=d.noSleep)==null||t.enable(),await L({ctx:d.audioCtx}),h(e.name),d.intervalId=setInterval(j,f),l({current:e,process:o.countdown})},F=()=>{const{form:e,list:t,add:s,pause:i,reset:n,start:r}=v;e.addEventListener("submit",P),t.addEventListener("click",B),s.addEventListener("click",M),i.addEventListener("click",q),n.addEventListener("click",A),r.addEventListener("click",D)},J=async()=>{const e=new NoSleep,t=new(window.AudioContext||window.webkitAudioContext),i=new URLSearchParams(window.location.search).get("url");let n=[];i?(n=await N(i),localStorage.setItem("timers",JSON.stringify(n))):n=JSON.parse(localStorage.getItem("timers"))||[],F(),l({audioCtx:t,noSleep:e,process:n.length>0?o.ready:o.idle,timers:n})};document.addEventListener("DOMContentLoaded",J);
